var IOInterface=function o(){var o=require("nedb"),e=require("path"),n=new o({filename:e.join(require("nw.gui").App.dataPath,"NetworkCanvas.db"),autoload:!0}),i,t={};return t.init=function(o){notify("ioInterface initialising.",1),localStorage.getObject("activeSession")!==!1?(console.log("existing session found"),o(localStorage.getObject("activeSession"))):(console.log("no existing session"),n.insert([{NetworkCanvas:"initialised"}],function(e,n){e&&console.log("error with insert"),console.log(n),console.log(n[0]._id),i=n[0]._id,console.log("id has been set as "+i),localStorage.setObject("activeSession",i),o(n[0]._id)}))},t.save=function(o,e){delete session.userData._id,notify("IOInterface being asked to synchronise with data store:",2),notify("Data to be saved: ",1),notify(o,1),n.update({_id:e},o,{},function(o){o&&console.log("saving failed"),console.log("saving worked...id for find: "+e),n.find({_id:e},function(o,e){o&&(console.log("error with finding"),console.log(o)),console.log("data is now: "),console.log(e[0])})})},t.update=function(o,e,i){n.update({_id:i},e,{},function(o){o&&console.log("saving failed"),console.log("update worked."),n.find({_id:i},function(o,e){o&&(console.log("error with finding"),console.log(o)),console.log("new data is: "),console.log(e[0])})})},t.reset=function(){n.find({},function(o,e){if(o)return console.log("resetting failed"),!1;for(var n=e.length,i=0;n>i;i++)t.deleteDocument(e[i]._id);require("nw.gui").Window.get().reload(3)})},t.deleteDocument=function(o){n.remove({_id:o},{},function(o){return o?(console.log("deleting document failed."),!1):void 0})},t.load=function(o,e){console.log("loading...id is "+e),notify("ioInterface being asked to load data.",2),n.find({_id:e},function(e,n){e&&console.log("error"),console.log("loading worked. Returning: "),console.log(n[0]),o(n[0])})},t};