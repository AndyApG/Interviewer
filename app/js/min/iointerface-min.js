var IOInterface=function e(){var e=require("nedb"),o=require("path"),t,n,i={};return i.init=function(i){global.tools.notify("ioInterface initialising.",1),t=new e({filename:o.join(window.require("nw.gui").App.dataPath,global.session.name+".db"),autoload:!0}),t.find({}).sort({date:1}).exec(function(e,o){if(e)return!1;if(void 0!==o.length&&o.length>0)i(o[0]._id);else{var a=new Date;t.insert([{date:a}],function(e,o){return e?!1:(n=o[0]._id,void i(o[0]._id))})}})},i.save=function(e,o){delete global.session.userData._id,global.tools.notify("IOInterface being asked to save to data store.",1),global.tools.notify("Data to be saved: ",2),global.tools.notify(e,2),t.update({_id:o},e,{},function(e){return e?!1:void global.tools.notify("Saving complete.",1)})},i.update=function(e,o,n){global.tools.notify("IOInterface being asked to update data store.",1),t.update({_id:n},o,{},function(e){return e?!1:void global.tools.notify("Updating complete.",1)})},i.reset=function(e){t.find({},function(o,t){if(o)return!1;for(var n=t.length,a=0;n>a;a++)i.deleteDocument(t[a]._id);e&&e()})},i.deleteDocument=function(e){global.tools.notify("ioInterface being asked to delete document.",2),t.remove({_id:global.session.id},{},function(o){return o?!1:(global.tools.notify("Deleting complete.",2),void(e&&e()))})},i.load=function(e,o){global.tools.notify("ioInterface being asked to load data.",2),t.find({_id:o},function(o,t){return o?!1:void e(t[0])})},i};module.exports=new IOInterface;