var DateInterface=function e(){var e={},t;return e.options={targetEl:$(".container"),edgeType:"Dyad",heading:"Default Heading"},e.init=function(a){global.tools.extend(e.options,a),e.options.targetEl.append("<h1>"+e.options.heading+"</h1>"),e.options.targetEl.append('<p class="lead">'+e.options.subheading+"</p>"),e.options.targetEl.append('<div class="date-container"></div>'),t=global.network.getEdges(e.options.criteria);var i=0,r=0;$.each(t,function(e,t){var a=global.network.getEdges({type:"Dyad",from:global.network.getNodes({type_t0:"Ego"})[0].id,to:t.to})[0],n='<div class="date-picker-item overlay"><div class="row"><div class="col-sm-12"><h2>Regarding <span>'+a.nname_t0+'</span></h2></div></div><div class="row"><div class="col-sm-12 alert alert-danger logic-error" role="alert"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span><span class="sr-only">Error:</span> Your last sexual encounter cannot come before your first. Please correct the dates before continuing.</div><div class="col-sm-5"><div class="form-group"><p class="lead">When was the first time you had sex?</p><div class="input-group date first row'+r+'" id="datetimepicker'+i+'"><input type="text" class="form-control" readonly /><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div><div class="checkbox"><label><input type="checkbox" name="checkbox-time" class="checkbox-time checkbox'+i+'"> More than 6 months ago.</label></div></div></div><div class="col-sm-5 col-sm-offset-2"><div class="form-group"><p class="lead">When was the last time you had sex?</p><div class="input-group date second row'+r+'" id="datetimepicker'+(i+1)+'"><input type="text" class="form-control" readonly /><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div></div></div>';$(n).appendTo(".date-container");var s={format:"MM/DD/YYYY"};$("#datetimepicker"+i).datetimepicker(s),$("#datetimepicker"+(i+1)).datetimepicker(s),$("#datetimepicker"+i+", #datetimepicker"+(i+1)).on("dp.change",function(e){var a={},i,r,n,s,d=$(this);$(this).hasClass("first")?($(".checkbox"+d.attr("id").slice(-1)).is(":checked")?(a.sex_first_before_range=!0,s=null):(a.sex_first_before_range=!1,s=d.data("DateTimePicker").date().format("MM/DD/YYYY")),i=parseInt(d.attr("id").slice(-1))+1,r=parseInt(d.attr("id").slice(-1)),n=parseInt(d.attr("id").slice(-1))+1,null!==e.date,a.sex_first_t0=s):($(".checkbox"+d.attr("id").slice(-1)).is(":checked")?(a.sex_last_before_range=!0,s=null):(a.sex_last_before_range=!1,s=d.data("DateTimePicker").date().format("MM/DD/YYYY")),i=parseInt(d.attr("id").slice(-1))-1,r=parseInt(d.attr("id").slice(-1))-1,n=parseInt(d.attr("id").slice(-1)),null!==e.date,a.sex_last_t0=s),global.network.updateEdge(t.id,a),global.moment($("#datetimepicker"+r).data("DateTimePicker").date()).isAfter($("#datetimepicker"+n).data("DateTimePicker").date())?(d.parent().parent().parent().children(".logic-error").fadeIn(),$(".arrow-next").attr("disabled","disabled")):(d.parent().parent().parent().children(".logic-error").fadeOut(),$(".arrow-next").removeAttr("disabled"))}),"undefined"!=typeof t.sex_first_t0&&(null===t.sex_first_t0?($(".checkbox"+i).prop("checked",!0),$("#datetimepicker"+i).data("DateTimePicker").date(global.moment().subtract(6,"months").format("MM/DD/YYYY")),$("#datetimepicker"+i).children().css({opacity:.5}),$("#datetimepicker"+i).data("DateTimePicker").disable()):$("#datetimepicker"+i).data("DateTimePicker").date(t.sex_first_t0)),"undefined"!=typeof t.sex_last_t0&&(null===t.sex_last_t0?($(".checkbox"+(i+1)).prop("checked",!0),$("#datetimepicker"+(i+1)).data("DateTimePicker").date(global.moment().subtract(6,"months").format("MM/DD/YYYY")),$("#datetimepicker"+(i+1)).children().css({opacity:.5}),$("#datetimepicker"+(i+1)).data("DateTimePicker").disable()):$("#datetimepicker"+(i+1)).data("DateTimePicker").date(t.sex_last_t0)),$(".checkbox"+i+", .checkbox"+(i+1)).change(function(e){var t=$(e.target);this.checked?(t.parent().parent().parent().children(".date").data("DateTimePicker").date(global.moment().subtract(6,"months").format("MM/DD/YYYY")),t.parent().parent().parent().children(".date").data("DateTimePicker").disable(),t.parent().parent().parent().children(".date").children().css({opacity:.5})):(t.parent().parent().parent().children(".date").data("DateTimePicker").enable(),t.parent().parent().parent().children(".date").children().css({opacity:1}),t.parent().parent().parent().children(".date").data("DateTimePicker").date(global.moment().format("MM/DD/YYYY")))}),i+=2,r++})},e.destroy=function(){},e};module.exports=new DateInterface;