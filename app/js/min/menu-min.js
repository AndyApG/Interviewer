var Menu=function n(e){var t={},o=[],i=!1,s=$(".menu-container"),a=!1,r=function(){t.closeMenu()};return t.options={onBeforeOpen:function(){$(".menu-btn").transition({opacity:0}),$(".menu-btn").hide(),$(".black").hide(),$(".arrow-next").transition({marginRight:-550},1e3),$(".arrow-prev").transition({marginLeft:-550},1e3),$(".content").addClass("pushed"),$(".pushed").on("click",r)},onAfterOpen:function(){return!1},onBeforeClose:function(){$(".content").removeClass("pushed"),$(".pushed").off("click",r)},onAfterClose:function(){$(".black").show(),$(".arrow-next").transition({marginRight:0},1e3),$(".arrow-prev").transition({marginLeft:0},1e3)}},t.getMenus=function(){return o},t.closeMenu=function(n){n?n.items.find(".icon-close").trigger("click"):$.each(o,function(n){var e="."+o[n].name+"-menu-container";$(e).hasClass("active")&&o[n].items.find(".icon-close").trigger("click")})},t.toggle=function(n){var e=n.button[0].getBoundingClientRect(),o=$("."+n.name+"-menu"),s=$("."+n.name+"-menu-container");if(o.addClass("no-transition"),o[0].style.left="auto",o[0].style.top="auto",i===!0)return!1;if(i=!0,n.expanded===!0)t.options.onBeforeClose(),s.removeClass("active"),setTimeout(t.options.onAfterClose,1e3),i=!1;else{t.options.onBeforeOpen();var a=global.tools.modifyColor($("."+n.name+"-menu").css("background-color"),-.2);$("body").css({"background-color":a}),s.addClass("active"),setTimeout(t.options.onAfterOpen,500),i=!1}setTimeout(function(){o[0].style.left=e.left+"px",o[0].style.top=e.top+"px",n.expanded===!0?(o.removeClass("no-transition"),s.removeClass("menu-open"),n.expanded=!1,$(".menu-btn").transition({opacity:1})):setTimeout(function(){o.removeClass("no-transition"),s.addClass("menu-open"),n.expanded=!0},25)},25)},t.addMenu=function(n,e){var i={};i.name=n,i.expanded=!1,i.button=$('<span class="hi-icon menu-btn '+n+'" style="opacity:0"></span>'),i.button.addClass(e).html(n),s.append(i.button),i.button.css({top:-300});var r=n+"-menu",c=n+"-menu-container";return i.items=$('<div class="morph-button morph-button-sidebar morph-button-fixed '+c+'"><div class="morph-content '+r+'"><div><div class="content-style-sidebar"><span class="icon icon-close">Close the overlay</span><h2>'+n+"</h2><ul></ul></div></div></div></div>"),i.button.after(i.items),i.button.on("click",function(){t.toggle(i)}),i.items.find(".icon-close").on("click",function(){$(".menu-btn").show(),t.toggle(i)}),o.push(i),a===!0?setTimeout(function(){i.button.transition({top:0,opacity:1},1e3).promise().done(function(){a=!1})},500):(a=!0,i.button.transition({top:0,opacity:1},1e3).promise().done(function(){a=!1})),i},t.removeMenu=function(n){n.button.transition({top:-300,opacity:0},1e3,function(){$(n.button).remove(),$(n.items).remove()})},t.addItem=function(n,e,o,i){var s=$('<li><a class="icon icon-server '+o+'" href="#">'+e+"</a></li>");n.items.find("ul").append(s),s.on("click",function(){$(".paginate").removeAttr("disabled"),t.closeMenu(n),setTimeout(function(){i()},500)})},t.init=function(){global.tools.notify("Menu initialising.",1),global.tools.extend(t.options,e)},t.init(),t};module.exports=new Menu;