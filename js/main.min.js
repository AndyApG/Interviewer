//helper functions go here
var touchNumber=0,Notify=function(e,t){console.log(e)},randomBetween=function(e,t){return Math.random()*(t-e)+e};Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))};Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)};var NetCanvas=function(){var e,t,n,r,s,o,u,a,f,l=[],c=[],h=[],p=33,d=!0,v=!0,m=1,g=!1,y={},b=[];b.blue="#0174DF";b.edge="#888";var w=new Array("Barney","Jonathon","Myles","Alethia","Tammera","Veola","Meredith","Renee","Grisel","Celestina","Fausto","Eliana","Raymundo","Lyle","Carry","Kittie","Melonie","Elke","Mattie","Kieth","Lourie","Marcie","Trinity","Librada","Lloyd","Pearlie","Velvet","Stephan","Hildegard","Winfred","Tempie","Maybelle","Melynda","Tiera","Lisbeth","Kiera","Gaye","Edra","Karissa","Manda","Ethelene","Michelle","Pamella","Jospeh","Tonette","Maren","Aundrea","Madelene","Epifania","Olive");y.init=function(){if(g)return;g=!0;this.initKinetic();this.drawUIComponents();this.loadGraph()};y.addNode=function(e,t,n,i){var o,u,f=i!=null?i:w[Math.round(randomBetween(0,w.length-1))],h=t!=null?t:p;if(e!=null){o=e[0];u=e[1]}else{o=Math.round(randomBetween(100,window.innerWidth-100));u=Math.round(randomBetween(100,window.innerHeight-100))}var d=new Kinetic.Group({id:l.length,draggable:!0,y:u,x:o,name:f,edges:[]}),v=new Kinetic.Circle({dashArray:[15,3],radius:h,stroke:b.blue,strokeWidth:10}),m=new Kinetic.Text({text:f,fontSize:15,fontFamily:"Raleway",fill:"red",offsetX:-40,offsetY:10});d.add(v);d.add(m);Notify("Putting node "+f+" at coordinates x:"+o+", y:"+u,"success");d.on("dragstart dragmove",function(){var e=this;$.each(c,function(t,n){if(n.attrs.from==e||n.attrs.to==e){var r=[n.attrs.from.attrs.x,n.attrs.from.attrs.y,n.attrs.to.attrs.x,n.attrs.to.attrs.y];n.attrs.points=r}});r.draw()});d.on("mousedown tap",function(){touchNumber++;Notify("Touchstart");Notify("Touch number: "+touchNumber)});d.on("mouseup touchend",function(){touchNumber--;Notify("Touchend");Notify("Touch number: "+touchNumber)});d.on("dragend",function(){a.children[0].setListening(!0);y.saveGraph()});s.add(d);l.push(d);d.moveToBottom();s.draw();return d};y.getNodeByID=function(e){var t={};$.each(l,function(n,r){r.attrs.id==e&&(t=r)});return t};y.addEdge=function(e,t){var n=!1,i,o;if(e!=null&&typeof e=="object"||t!=null&&typeof t=="object"){i=e;o=t}else{i=y.getNodeByID(e);o=y.getNodeByID(t)}$.each(c,function(e,t){if(t.attrs.from==o||t.attrs.to==o)n=!0});if(n||i===o){Notify("Edge already exists. Cancelling.","error");return!1}var u=[i.attrs.x,i.attrs.y,o.attrs.x,o.attrs.y],a=new Kinetic.Line({strokeWidth:2,stroke:b.edge,from:i,to:o,points:u});c.push(a);r.add(a);r.draw();s.draw();Notify("Created Edge between "+i.children[1].attrs.text+" and "+o.children[1].attrs.text,"success");return!0};y.getSimpleEdges=function(){var e={},t=0;$.each(c,function(n,r){e[t]={};e[t].from=r.attrs.from.attrs.id;e[t].to=r.attrs.to.attrs.id;t++});return e};y.initKinetic=function(){e=new Kinetic.Stage({container:"kineticCanvas",width:window.innerWidth,height:window.innerHeight});n=new Kinetic.Layer;s=new Kinetic.Layer;r=new Kinetic.Layer;a=new Kinetic.Layer;e.add(n);e.add(r);e.add(s);e.add(a)};y.loadGraph=function(){Notify("Loading graph from localStorage.");loadedNodes=localStorage.getObject("nodes");loadedEdges=localStorage.getObject("edges");$.each(loadedNodes,function(e,t){var n=[];n.push(t.x);n.push(t.y);var r=t.name;y.addNode(n,null,null,r)});$.each(loadedEdges,function(e,t){y.addEdge(t.from,t.to)})};y.saveGraph=function(){Notify("Saving graph.");simpleNodes=y.getSimpleNodes();simpleEdges=y.getSimpleEdges();localStorage.setObject("nodes",simpleNodes);localStorage.setObject("edges",simpleEdges)};y.getNodes=function(){return l};y.getEdges=function(){return c};y.getSimpleNodes=function(){var e=new Object;$.each(l,function(t,n){e[n.attrs.id]={};e[n.attrs.id].x=n.attrs.x;e[n.attrs.id].y=n.attrs.y;e[n.attrs.id].name=n.attrs.name});return e};y.getEdges=function(){return c};y.drawUIComponents=function(){var t={circleColor:"#C3D5E6",circleNumber:4},r,s,o=t.circleColor,u=window.innerHeight-p*2;for(i=0;i<t.circleNumber;i++){var f=1-i/t.circleNumber,l=u/2*f,s=new Kinetic.Circle({x:window.innerWidth/2,y:window.innerHeight/2,radius:l,stroke:"white",strokeWidth:1.5,opacity:0}),r=new Kinetic.Circle({x:window.innerWidth/2,y:window.innerHeight/2,radius:l,fill:o,strokeWidth:0});o=tinycolor.darken(o,amount=15).toHexString();n.add(r);n.add(s)}var c=new Kinetic.Circle({radius:50,stroke:"#666",strokeWidth:0,y:window.innerHeight-100,x:100});c.on("click tap",function(){var t=e.getPointerPosition(),n=new Array;n[0]=t.x;n[1]=t.y;console.log(n);var r=y.addNode(n);c.moveToBottom();nodeOrigin.setListening(!1);a.draw()});a.add(c);n.draw();a.draw()};y.clearGraph=function(){r.removeChildren();r.clear();s.removeChildren();s.clear();l=[];c=[]};y.createRandomGraph=function(e,t){e=e||10;t=t||.4;Notify("Creating random graph...");for(i=0;i<e;i++){var n=i+1;Notify("Adding node "+n+" of "+e);y.addNode()}Notify("Adding edges.");$.each(l,function(e,n){if(randomBetween(0,1)<t){var r=Math.round(randomBetween(0,l.length-1));y.addEdge(l[e],l[r])}})};return y}();window.onload=function(){$("#menu-button").click(function(){console.log($(".menu-container").css("opacity"));if($(".menu-container").css("opacity")=="1"){$(".menu-item").animate({marginLeft:"-110px"},1e3,"easeOutQuint");$(".menu-container").animate({opacity:"0"},1e3,"easeOutQuint")}else{$(".menu-item").animate({marginLeft:0},1e3,"easeOutQuint");$(".menu-container").animate({opacity:"1"},1e3,"easeOutQuint")}});mySwiper=new Swiper(".swiper-container",{mode:"horizontal",loop:!1,autoResize:!0,keyboardControl:!0,speed:1e3,onlyExternal:!0,onSlideChangeStart:function(e){},onSlideChangeEnd:function(){}});NetCanvas.init()};