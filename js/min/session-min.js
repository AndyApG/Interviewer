var Session=function e(t){var a={},n=0,i=$("#content");window.dataStore={},a.id=0,a.userData={};var o;a.stages=[{label:"Intro",page:"intro.html"},{label:"NG: closest",page:"namegen1.html"},{label:"NG: time, energy",page:"namegen2.html"},{label:"NG: $25",page:"namegen3.html"},{label:"NG: gay issues",page:"namegen4.html"},{label:"Page title",page:"listselect1.html"},{label:"Page title",page:"namegen5.html"},{label:"Page title",page:"namegenmod6.html"},{label:"Page title",page:"listselect2.html"},{label:"Page title",page:"namegen7.html"},{label:"Page title",page:"namegenmod8.html"},{label:"Page title",page:"multibin1.html"},{label:"Page title",page:"multibin2.html"},{label:"Page title",page:"multibin3.html"},{label:"Page title",page:"multibin4.html"},{label:"Page title",page:"test.html"}];var s;return a.options={fnBeforeStageChange:function(e,t){var a=new CustomEvent("changeStageStart",{detail:{oldStage:e,newStage:t}});window.dispatchEvent(a)},fnAfterStageChange:function(e,t){var a=new CustomEvent("changeStageEnd",{detail:{oldStage:e,newStage:t}});window.dispatchEvent(a)}},a.init=function(){notify("Session initialising.",1),extend(a.options,t),window.addEventListener("changeStageStart",function(){$(".loader").transition({opacity:1})},!1),window.addEventListener("changeStageEnd",function(){$(".loader").transition({opacity:0})},!1),window.dataStore=new IOInterface,localStorage.getObject("activeSession")!==!1?(a.id=localStorage.getObject("activeSession"),notify("Existing session found (session id: "+a.id+"). Loading.",3),window.dataStore.init(a.id),window.dataStore.load(a.updateUserData)):(notify("No existing session found. Creating new session.",3),a.id=window.dataStore.init()),a.registerData("session"),History.Adapter.bind(window,"statechange",function(){});var e=History.getState();a.goToStage(e.data.stage?e.data.stage:0),window.addEventListener("unsavedChanges",function(){a.saveManager()},!1);var n=menu.addMenu("Session","hi-icon-cog");menu.addItem(n,"Load Data by ID","icon-user",function(){return!0}),menu.addItem(n,"Reset Session","icon-globe",a.reset),menu.addItem(n,"Download Data","icon-briefcase",function(){return!0}),menu.addItem(n,"Sync with Server","icon-cloud",a.saveData);var i=menu.addMenu("Stages","hi-icon-list");$.each(a.stages,function(e,t){menu.addItem(i,t.label,"icon-cloud",function(){a.goToStage(e)})})},a.reset=function(){notify("Resetting session.",2),localStorage.removeItem("activeSession"),localStorage.removeItem("nodes"),localStorage.removeItem("edges"),localStorage.removeItem("session"),localStorage.removeItem("log"),a.id=0,a.currentStage=0,window.dataStore.save(a.userData),History.pushState({stage:0},null,"?stage=0"),location.reload()},a.saveManager=function(){clearTimeout(s),s=setTimeout(a.saveData,3e3)},a.updateUserData=function(e){notify("Updating user data.",2),notify("Using the following to update:",1),notify(e,1),notify("session.userData is:",1),notify(a.userData,1),extend(a.userData,e),notify("Combined output is:",0),notify(a.userData,0);var t=new Event("newDataLoaded");window.dispatchEvent(t);var n=new Event("unsavedChanges");window.dispatchEvent(n)},a.returnSessionID=function(){return a.id},a.saveData=function(){window.dataStore.save(a.userData),o=new Date},a.goToStage=function(e){if("undefined"==typeof e||"undefined"==typeof a.stages[e])return!1;notify("Session is moving to stage "+e,3),a.options.fnBeforeStageChange(n,e);var t=e;i.transition({opacity:"0"},400,"easeInSine").promise().done(function(){i.load("stages/"+a.stages[e].page,function(){i.transition({opacity:"1"},400,"easeInSine")})});var o=n;n=t,History.pushState({stage:e},null,"?stage="+e),a.options.fnAfterStageChange(o,n);var s=new Event("unsavedChanges");window.dispatchEvent(s)},a.nextStage=function(){a.goToStage(n+1)},a.prevStage=function(){a.goToStage(n-1)},a.addStage=function(){},a.registerData=function(e,t){notify('A script requested a data store be registered with the key "'+e+'".',2),void 0===a.userData[e]?(notify('Key named "'+e+'" was not already registered. Creating.',1),a.userData[e]=t?[]:{}):notify("A data store with this key already existed. Returning a pointer.",1);var n=new Event("unsavedChanges");return window.dispatchEvent(n),a.userData[e]},a.addData=function(e,t,n){n||(n=!1),n===!0?a.userData[e].push(t):extend(a.userData[e],t),notify("Adding data to key '"+e+"'.",2),notify(t,1);var i=new Event("unsavedChanges");window.dispatchEvent(i)},a.returnData=function(e){return e&&"undefined"!=typeof a.userData[e]?a.userData[e]:a.userData},a.init(),a};
//# sourceMappingURL=./session-min.js.map