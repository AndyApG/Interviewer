var MultiBin=function e(n){var t={};t.options={targetEl:$(".container"),edgeType:"Dyad",variable:{label:"gender_p_t0",values:["Female","Male","Transgender","Don't Know","Won't Answer"]},heading:"Default Heading",subheading:"Default Subheading."};var o=!1;extend(t.options,n);var i=function(){t.destroy()},a=function(e){e.stopPropagation(),e.target!==e.currentTarget&&(console.log(e),console.log("back"),console.log("open: "+o),o===!0?(console.log("closing"),$(".container").children().removeClass("invisible"),$(".copy").removeClass("node-bin-active"),$(".copy").addClass("node-bin-static"),$(".copy").children("h1, h4").show(),$(".copy").removeClass("copy"),$(".draggable").draggable({cursor:"pointer",revert:"invalid"}),o=!1):console.log("rejecting"))},d=function(e){if(e.stopPropagation(),o===!1){if(console.log(e),!$(this).hasClass(".node-bin-active")){$(".container").children().not(this).addClass("invisible");var n=$(this).offset(),t=$(this);t.offset(n),t.addClass("node-bin-active copy"),t.removeClass("node-bin-static"),t.children("h1, h4").hide(),t.children(".active-node-list").children(".node-item").css({top:0,left:20,opacity:0}),setTimeout(function(){t.addClass("node-bin-active"),$.each($(".active-node-list").children(),function(e,n){setTimeout(function(){$(n).transition({left:0,opacity:1})},50*e)})},400)}o=!0}},s=function(e){e.stopPropagation(),console.log("node clicked");var n=$(this),o=$(this).parent().parent().data("index");if($(this).parent().hasClass("active-node-list")){var i=network.getEdges({from:network.getNodes({type_t0:"Ego"})[0].id,to:n.data("node-id"),type:"Dyad"})[0].id,a={};a[t.options.variable.label]="",network.updateEdge(i,a),$(this).appendTo(".node-bucket");var d="people";1===$(".n"+o).children(".active-node-list").children().length&&(d="person"),$(".n"+o).children("h4").html(0===$(".n"+o).children(".active-node-list").children().length?"(Empty)":$(".n"+o).children(".active-node-list").children().length+" "+d+".")}};return t.destroy=function(){notify("Destroying multiBin.",0),window.removeEventListener("changeStageStart",i,!1),$(".node-bin-static").off("click",d),$(".node-item").off("click",s),$(".content").off("click",a)},t.init=function(){t.options.targetEl.append("<h1>"+t.options.heading+"</h1>"),t.options.targetEl.append('<h4">'+t.options.subheading+"</h4>"),t.options.targetEl.append('<div class="node-bucket"></div>');var e=Math.floor(.66*t.options.variable.values.length);console.log("two thirds of number: "+e),console.log("container outer: "+$(".container").outerWidth());var n=$(".container").outerWidth()/e;console.log("item size: "+n);for(var o=n;2*o>$(".container").height()-50;)o=.98*o;console.log(o);var l=network.getEdges({from:network.getNodes({type_t0:"Ego"})[0].id,type:t.options.edgeType}),r=!1;$.each(t.options.variable.values,function(n,o){n+1>e&&r===!1&&(console.log("yesssss"),t.options.targetEl.append("<br>"),r=!0);var i=$('<div class="node-bin node-bin-static n'+n+'" data-index="'+n+'"><h1>'+o+'</h1><h4>(Empty)</h4><div class="active-node-list"></div></div>');i.data("index",n),t.options.targetEl.append(i),$(".n"+n).droppable({accept:".draggable",drop:function(e,o){var i=o.draggable,a=$(this);$(i).appendTo(a.children(".active-node-list"));var d={};d[t.options.variable.label]=t.options.variable.values[n];var s=network.getEdges({from:network.getNodes({type_t0:"Ego"})[0].id,to:$(i).data("node-id"),type:"Dyad"})[0].id;network.updateEdge(s,d);var l="people";1===$(".n"+n+" .active-node-list").children().length&&(l="person"),$(".n"+n+" h4").html($(".n"+n+" .active-node-list").children().length+" "+l+".");var r=$(".n"+n);r.transition({scale:1.2},200,"ease"),setTimeout(function(){r.transition({background:r.data("oldBg")},200,"ease"),r.transition({scale:1},200,"ease")},0)},over:function(){$(this).data("oldBg",$(this).css("background-color")),$(this).stop().transition({background:"rgba(255, 193, 0, 1.0)"},400,"ease")},out:function(){$(this).stop().transition({background:$(this).data("oldBg")},500,"ease")}})}),$(".node-bin").css({width:.6*o-20,height:.6*o-20}),$(".node-bin").slice(0,e).css({width:o-20,height:o-20}),$(".node-bin h1").css({marginTop:o/3}),$.each($(".node-bin"),function(e,n){var t=$(n).offset();$(n).data("oldPos",t),$(n).css(t)}),$(".node-bin").css({position:"absolute"}),$.each(l,function(e,n){if(void 0!==n[t.options.variable.label]&&""!==n[t.options.variable.label]){e=t.options.variable.values.indexOf(n[t.options.variable.label]),console.log("index: "+e),console.log($(".n"+e)),$(".n"+e).children(".active-node-list").append('<div class="node-item draggable" data-node-id="'+n.to+'">'+n.nname_t0+"</div>");var o="people";1===$(".n"+e).children(".active-node-list").children().length&&(o="person"),$(".n"+e).children("h4").html(0===$(".n"+e).children(".active-node-list").children().length?"(Empty)":$(".n"+e).children(".active-node-list").children().length+" "+o+".")}else $(".node-bucket").append('<div class="node-item draggable" data-node-id="'+n.to+'">'+n.nname_t0+"</div>")}),$(".draggable").draggable({cursor:"pointer",revert:"invalid"}),window.addEventListener("changeStageStart",i,!1),$(".node-bin-static").on("click",d),$(".node-item").on("click",s),$(".content").on("click",a)},t.init(),t};