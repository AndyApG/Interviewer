var Namegenerator=function e(a){var t={};t.options={nodeType:"Alter",edgeType:"Dyad",targetEl:$(".container"),variables:[],heading:"This is a default heading",subheading:"And this is a default subheading"},extend(t.options,a);var o=!1,i=!1,n=network.getNodes({type_t0:"Alter"}).length,r={Friend:["Best Friend","Friend","Ex-friend","Other type"],"Family/Relative":["Parent/Guardian","Brother/Sister","Grandparent","Other Family","Chosen Family"],"Romantic/Sexual Partner":["Boyfriend/Girlfriend","Ex-Boyfriend/Ex-Girlfriend","Booty Call/Fuck Buddy/Hook Up","One Night Stand","Other type of Partner"],"Acquaintaince/Associate":["Coworker-Colleague","Classmate","Roommate","Friend of a Friend","Neighbor","Other"],"Other Support/Source of Advice":["Teacher/Professor","Counselor/Therapist","Community Agency Staff","Religious Leader","Mentor","Coach","Other"],"Drug Use":["Someone you use drugs with","Someone you buy drugs from"],Other:[]},l=function(e){13===e.keyCode&&(e.preventDefault(),o===!1?t.openNodeBox():o===!0&&$(".submit-1").click()),27===e.keyCode&&t.closeNodeBox(),8!==e.keyCode||$(e.target).is("input, textarea")||e.preventDefault()},s=function(e){if(o===!0&&13!==e.keyCode&&$("#fname_t0").val().length>0&&$("#fname_t0").val().length>0){var a=$("#fname_t0").val()+" "+$("#lname_t0").val().charAt(0);$("#lname_t0").val().length>0&&(a+=".");var t=function(){$("#nname_t0").val(a)};setTimeout(t,0)}},p=function(){var e=$(this).data("index"),a=network.getEdges({from:network.getNodes({type_t0:"Ego"})[0].id,to:e,type:"Dyad"})[0];i=e,$.each(t.options.variables,function(e,o){o.private===!1&&("relationship"===o.type?$("select[name='"+o.variable+"']").val(a[o.variable]):"subrelationship"===o.type?($("select[name='reltype_sub_t0']").children().remove(),$("select[name='reltype_sub_t0']").append('<option value="">Choose a specific relationship</option>'),$.each(r[$("select[name='reltype_main_t0']").val()],function(e,a){$("select[name='reltype_sub_t0']").append('<option value="'+a+'">'+a+"</option>")}),$("select[name='"+o.variable+"']").val(a[o.variable]),$("select[name='reltype_sub_t0']").prop("disabled",!1),void 0!==a.reltype_oth_t0&&""!==a.reltype_oth_t0&&($(".reltype_oth_t0").val(a.reltype_oth_t0),$(".reltype_oth_t0").show())):$("#"+o.variable).val(a[o.variable]),t.openNodeBox())})},d=function(){t.closeNodeBox()};return t.openNodeBox=function(){$(".newNodeBox").transition({scale:1,opacity:1},300),$("#ngForm input:text").first().focus(),o=!0},t.closeNodeBox=function(){$(".newNodeBox").transition({scale:.1,opacity:0},500),o=!1,$("#ngForm").trigger("reset"),$(".reltype_oth_t0").hide(),i=!1},t.init=function(){var e=$('<h1 class="text-center"></h1>').html(t.options.heading);t.options.targetEl.append(e);var a=$('<p class="lead"></p>').html(t.options.subheading);t.options.targetEl.append(a);var o=$('<div class="alter-count-box"></div>');t.options.targetEl.append(o);var c=$('<div class="newNodeBox"><form role="form" id="ngForm" class="form"><div class="col-sm-6 left"><h2 style="margin-top:0">Adding a Node</h2><ul><li>Try to be as accurate as you can, but don\'t worry if you aren\'t sure.</li><li>We are interested in your perceptions, so there are no right answers!</li><li>You can use the tab key to quickly move between the fields.</li><li>You can use the enter key to submit the form.</li></ul></div><div class="col-sm-6 right"></div></form></div>');t.options.targetEl.append(c),$.each(t.options.variables,function(e,a){if(a.private!==!0){var t,o;switch(a.type){case"text":t=$('<div class="form-group '+a.variable+'"><label class="sr-only" for="'+a.variable+'">'+a.label+'</label><input type="text" class="form-control '+a.variable+'" id="'+a.variable+'" placeholder="'+a.label+'"></div></div>');break;case"number":t=$('<div class="form-group '+a.variable+'"><label class="sr-only" for="'+a.variable+'">'+a.label+'</label><input type="number" class="form-control '+a.variable+'" id="'+a.variable+'" placeholder="'+a.label+'"></div></div>');break;case"relationship":o=$('<select class="form-control" name="'+a.variable+'"><option value="">Choose a relationship category</option></select>'),$.each(r,function(e){o.append('<option value="'+e+'">'+e+"</option>")}),t=$('<div class="form-group '+a.variable+'"></div></div>'),t.append(o);break;case"subrelationship":o=$('<select class="form-control" name="'+a.variable+'"><option value="">Choose a specific relationship</option></select>'),$.each(r,function(e){o.append('<option value="'+e+'">'+e+"</option>")}),t=$('<div class="form-group '+a.variable+'"></div>'),t.append(o)}$(".newNodeBox .form .right").append(t),a.required===!0&&("relationship"===a.type?$("select[name='"+a.variable+"']").prop("required",!0):$("#"+a.variable).prop("required",!0))}}),$("select[name='reltype_sub_t0']").prop("disabled",!0);var v=$('<div class="col-sm-6 text-center"><button type="submit" class="btn btn-primary btn-block submit-1">Add</button></div><div class="col-sm-6"><span class="btn btn-danger btn-block cancel">Cancel</span></div>');$(".newNodeBox .form .right").append(v);var u=$('<div class="table nameList"></div>');t.options.targetEl.append(u),$(document).on("keydown",l),$(".cancel").on("click",d),$("#fname_t0, #lname_t0").keyup(s),$(".reltype_oth_t0").hide(),$(document).on("click",".card",p),$("select[name='reltype_main_t0']").change(function(){return""===$("select[name='reltype_main_t0']").val()?($("select[name='reltype_sub_t0']").prop("disabled",!0),!1):($("select[name='reltype_sub_t0']").prop("disabled",!1),$("select[name='reltype_sub_t0']").children().remove(),$("select[name='reltype_sub_t0']").append('<option value="">Choose a specific relationship</option>'),void $.each(r[$("select[name='reltype_main_t0']").val()],function(e,a){$("select[name='reltype_sub_t0']").append('<option value="'+a+'">'+a+"</option>")}))}),$("select[name='reltype_sub_t0']").change(function(){"Other"===$("select[name='reltype_sub_t0']").val()?$(".reltype_oth_t0").show():($(".reltype_oth_t0").val(""),$(".reltype_oth_t0").hide())}),$("#ngForm").submit(function(e){e.preventDefault();var a={},o={};$.each(t.options.variables,function(e,t){"edge"===t.target?a[t.variable]=t.private===!0?t.value:"relationship"===t.type||"subrelationship"===t.type?$("select[name='"+t.variable+"']").val():$("#"+t.variable).val():"node"===t.target&&(o[t.variable]=t.private===!0?t.value:"relationship"===t.type||"subrelationship"===t.type?$("select[name='"+t.variable+"']").val():$("#"+t.variable).val())});var r={},l={};if(i===!1){extend(r,o);var s=network.addNode(r),p;$.each(t.options.edgeTypes,function(e,a){var o={},i=a;$.each(t.options.variables,function(e,a){"edge"===a.target&&a.edge===i&&(o[a.variable]=a.private===!0?a.value:"relationship"===a.type||"subrelationship"===a.type?$("select[name='"+a.variable+"']").val():$("#"+a.variable).val())}),l={from:network.getNodes({type_t0:"Ego"})[0].id,to:s,type:i},extend(l,o),p=network.addEdge(l)});var d=network.getEdges({id:p,type:"Dyad"})[0];console.log(p),console.log(d),t.addToList(d),n++,$(".alter-count-box").html(n)}else{var c=function(){var e=$("div[data-index="+i+"]");e.stop().transition({background:"rgba(51, 160, 117, 1)"},400,"ease"),setTimeout(function(){e.stop().transition({background:"rgba(238,238,238, 1)"},800,"ease")},1500)},v=i;$.each(t.options.edgeTypes,function(e,a){var o=a,n={};$.each(t.options.variables,function(e,a){"edge"===a.target&&a.edge===o&&(n[a.variable]=a.private===!0?a.value:"relationship"===a.type||"subrelationship"===a.type?$("select[name='"+a.variable+"']").val():$("#"+a.variable).val())});var r=network.getEdges({from:network.getNodes({type_t0:"Ego"})[0].id,to:i,type:a});$.each(r,function(e,a){network.updateEdge(a.id,n,c)})}),network.updateNode(v,o);var u=extend(a,o);$("div[data-index="+i+"]").html(""),$("div[data-index="+i+"]").append("<h4>"+u.nname_t0+"</h4>");var b=$("<ul></ul>");$.each(t.options.variables,function(e,a){a.private===!1&&void 0!==u[a.variable]&&""!==u[a.variable]&&b.append('<li class="'+u[a.variable]+'"><strong>'+a.label+"</strong>: "+u[a.variable]+"</li>")}),$("div[data-index="+i+"]").append(b),i=!1}t.closeNodeBox()}),$(".alter-count-box").html(n)},t.addToList=function(e){var a;a=$('<div class="card" data-index="'+e.to+'"><h4>'+e.nname_t0+"</h4></div>");var o=$("<ul></ul>");$.each(t.options.variables,function(a,t){t.private===!1&&void 0!==e[t.variable]&&""!==e[t.variable]&&o.append('<li class="'+e[t.variable]+'"><strong>'+t.label+"</strong>: "+e[t.variable]+"</li>")}),a.append(o),$(".nameList").append(a)},t.update=function(e){var a={};$.each(t.options.variables,function(t,o){a[o.variable]=o.private===!0?o.value:$("div[data-index="+e+"]").children("."+o.variable).html()});var o=function(){$("tr[data-index="+e+"]").stop().transition({background:"rgba(51, 160, 117, 1)"},800,"ease"),setTimeout(function(){$("tr[data-index="+e+"]").stop().transition({background:"rgba(0,0,0,0)"},1800,"ease")},1500),$("#ngForm input:text").first().focus()};network.updateEdge(e,a,o)},t.init(),t};