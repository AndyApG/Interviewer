var Namegenerator=function e(a){var t={};t.options={targetEl:$(".container"),variables:[],heading:"This is a default heading",subheading:"And this is a default subheading"},extend(t.options,a);var o=!1,i=network.getNodes({type_t0:"Alter"}).length,n={Friend:["Best Friend","Friend","Ex-friend","Other type"],"Family/Relative":["Parent/Guardian","Brother/Sister","Grandparent","Other Family","Chosen Family"],"Romantic/Sexual Partner":["Boyfriend/Girlfriend","Ex-Boyfriend/Ex-Girlfriend","Booty Call/Fuck Buddy/Hook Up","One Night Stand","Other type of Partner"],"Acquaintaince/Associate":["Coworker-Colleague","Classmate","Roommate","Friend of a Friend","Neighbor","Other"],"Other Support/Source of Advice":["Teacher/Professor","Counselor/Therapist","Community Agency Staff","Religious Leader","Mentor","Coach","Other"],"Drug Use":["Someone you use drugs with","Someone you buy drugs from"],Other:[]},l=function(e){13===e.keyCode&&(e.preventDefault(),o===!1?t.openNodeBox():o===!0&&$(".submit-1").click()),27===e.keyCode&&t.closeNodeBox(),8!==e.keyCode||$(e.target).is("input, textarea")||e.preventDefault()},r=function(e){if(13!==e.keyCode&&$("#fname_t0").val().length>0&&$("#fname_t0").val().length>0){var a=$("#fname_t0").val()+" "+$("#lname_t0").val().charAt(0);$("#lname_t0").val().length>0&&(a+=".");var t=function(){$("#nname_t0").val(a)};setTimeout(t,0)}},s=function(){var e=$(this).data("index"),a=network.getEdge(e);$.each(t.options.variables,function(e,o){o.private===!1&&("relationship"===o.type?$("select[name='"+o.variable+"']").val(a[o.variable]):"subrelationship"===o.type?($("select[name='"+o.variable+"']").val(a[o.variable]),void 0!==$("select[name='"+o.variable+"']").val(a[o.variable])&&""!==$("select[name='"+o.variable+"']").val(a[o.variable])&&($("select[name='reltype_sub_t0']").prop("disabled",!1),$(".reltype_oth_t0").show())):$("#"+o.variable).val(a[o.variable]),t.openNodeBox())})},d=function(){t.closeNodeBox()};return t.openNodeBox=function(){$(".newNodeBox").transition({scale:1,opacity:1},300),o=!0},t.closeNodeBox=function(){$(".newNodeBox").transition({scale:.1,opacity:0},500),o=!1},t.init=function(){var e=$('<h1 class="text-center"></h1>').html(t.options.heading);t.options.targetEl.append(e);var a=$('<p class="lead"></p>').html(t.options.subheading);t.options.targetEl.append(a);var o=$('<div class="alter-count-box"></div>');t.options.targetEl.append(o);var c=$('<div class="newNodeBox"><form role="form" id="ngForm" class="form"><div class="col-sm-6 left"><h2 style="margin-top:0">Adding a Node</h2><ul><li>Try to be as accurate as you can, but don\'t worry if you aren\'t sure.</li><li>We are interested in your perceptions, so there are no right answers!</li><li>You can use the tab key to quickly move between the fields.</li><li>You can use the enter key to submit the form.</li></ul></div><div class="col-sm-6 right"></div></form></div>');t.options.targetEl.append(c),$.each(t.options.variables,function(e,a){if(a.private!==!0){var t,o;switch(a.type){case"text":t=$('<div class="form-group '+a.variable+'"><label class="sr-only" for="'+a.variable+'">'+a.label+'</label><input type="text" class="form-control '+a.variable+'" id="'+a.variable+'" placeholder="'+a.label+'"></div></div>');break;case"number":t=$('<div class="form-group '+a.variable+'"><label class="sr-only" for="'+a.variable+'">'+a.label+'</label><input type="number" class="form-control '+a.variable+'" id="'+a.variable+'" placeholder="'+a.label+'"></div></div>');break;case"relationship":o=$('<label class="sr-only" for="'+a.variable+'">'+a.label+'</label><select class="form-control" name="'+a.variable+'"><option value="">Choose a relationship category</option></select>'),$.each(n,function(e){o.append('<option value="'+e+'">'+e+"</option>")}),t=$('<div class="form-group '+a.variable+'"></div></div>'),t.append(o);break;case"subrelationship":o=$('<label class="sr-only" for="'+a.variable+'">'+a.label+'</label><select class="form-control" name="'+a.variable+'"><option value="">Choose a specific relationship</option></select>'),$.each(n,function(e){o.append('<option value="'+e+'">'+e+"</option>")}),t=$('<div class="form-group '+a.variable+'"></div>'),t.append(o)}$(".newNodeBox .form .right").append(t),a.required===!0&&$("#"+a.variable).prop("required",!0)}}),$("select[name='reltype_sub_t0']").prop("disabled",!0);var p=$('<div class="col-sm-6 text-center"><button type="submit" class="btn btn-primary btn-block submit-1">Add</button></div><div class="col-sm-6"><span class="btn btn-danger btn-block cancel">Cancel</span></div>');$(".newNodeBox .form .right").append(p);var v=$('<div class="table nameList"></div>');t.options.targetEl.append(v),$(document).on("keydown",l),$(".cancel").on("click",d),$("#fname_t0, #lname_t0").keyup(r),$(".reltype_oth_t0").hide(),$(document).on("click",".card",s),$("select[name='reltype_main_t0']").change(function(){return""===$("select[name='reltype_main_t0']").val()?($("select[name='reltype_sub_t0']").prop("disabled",!0),!1):($("select[name='reltype_sub_t0']").prop("disabled",!1),$("select[name='reltype_sub_t0']").children().remove(),$("select[name='reltype_sub_t0']").append('<option value="">Choose a specific relationship</option>'),void $.each(n[$("select[name='reltype_main_t0']").val()],function(e,a){$("select[name='reltype_sub_t0']").append('<option value="'+a+'">'+a+"</option>")}))}),$("select[name='reltype_sub_t0']").change(function(){"Other"===$("select[name='reltype_sub_t0']").val()?$(".reltype_oth_t0").show():($(".reltype_oth_t0").val(""),$(".reltype_oth_t0").hide())}),$("#ngForm").submit(function(e){e.preventDefault();var a={},o={};$.each(t.options.variables,function(e,t){"edge"===t.target?a[t.variable]=t.private===!0?t.value:"relationship"===t.type||"subrelationship"===t.type?$("select[name='"+t.variable+"']").val():$("#"+t.variable).val():"node"===t.target&&(o[t.variable]=t.private===!0?t.value:"relationship"===t.type||"subrelationship"===t.type?$("select[name='"+t.variable+"']").val():$("#"+t.variable).val())});var n={};extend(n,o);var l=network.addNode(n),r={from:network.getNodes({type_t0:"Ego"})[0].id,to:l};extend(r,a),network.addEdge(r),t.addToList(r),i++,$(".alter-count-box").html(i),$("#ngForm").trigger("reset"),t.closeNodeBox()}),$(".alter-count-box").html(i)},t.addToList=function(e){var a;a=$('<div class="card" data-index="'+e.id+'"><h4>'+e.fname_t0+"</h4></div>");var o=$("<ul></ul>");$.each(t.options.variables,function(a,t){t.private===!1&&void 0!==e[t.variable]&&""!==e[t.variable]&&o.append('<li class="'+e[t.variable]+'"><strong>'+t.label+"</strong>: "+e[t.variable]+"</li>")}),a.append(o),$(".nameList").append(a)},t.update=function(e){var a={};$.each(t.options.variables,function(t,o){a[o.variable]=o.private===!0?o.value:$("tr[data-index="+e+"]").children("."+o.variable).html()});var o=function(){$("tr[data-index="+e+"]").stop().transition({background:"rgba(51, 160, 117, 1)"},800,"ease"),setTimeout(function(){$("tr[data-index="+e+"]").stop().transition({background:"rgba(0,0,0,0)"},1800,"ease")},1500),$("#ngForm input:text").first().focus()};network.updateEdge(e,a,o)},t.init(),t};