"use strict";var NetworkCanvas=function e(t){var n,o,i,r,a,d={},s=[],c=!1,l=!1,f={blue:"#0174DF",placidblue:"#83b5dd",violettulip:"#9B90C8",hemlock:"#9eccb3",paloma:"#aab1b0",freesia:"#ffd600",cayenne:"#c40000",celosiaorange:"#f47d44",sand:"#ceb48d",dazzlingblue:"#006bb6",edge:"#bbb",selected:"gold"},h={defaultNodeSize:20,defaultNodeColor:f.blue,defaultEdgeColor:f.edge,concentricCircleColor:"#ffffff",concentricCircleNumber:4,nodeTypes:[{name:"Person",color:f.blue},{name:"OnlinePerson",color:f.hemlock},{name:"Organisation",color:f.cayenne},{name:"Professional",color:f.violettulip}]},u=["Barney","Jonathon","Myles","Alethia","Tammera","Veola","Meredith","Renee","Grisel","Celestina","Fausto","Eliana","Raymundo","Lyle","Carry","Kittie","Melonie","Elke","Mattie","Kieth","Lourie","Marcie","Trinity","Librada","Lloyd","Pearlie","Velvet","Stephan","Hildegard","Winfred","Tempie","Maybelle","Melynda","Tiera","Lisbeth","Kiera","Gaye","Edra","Karissa","Manda","Ethelene","Michelle","Pamella","Jospeh","Tonette","Maren","Aundrea","Madelene","Epifania","Olive"];return d.init=function(){d.initKinetic(),d.drawUIComponents(),extend(h,t)},d.addNode=function(e){var t,n=Math.round(randomBetween(0,h.nodeTypes.length-1)),o=window.nodes.length+1,a={coords:[$(window).width()+50,100],id:o,label:u[Math.round(randomBetween(0,u.length-1))],size:h.defaultNodeSize,type:h.nodeTypes[n].name,color:h.nodeTypes[n].color,strokeWidth:4};extend(a,e),a.id=parseInt(a.id,10);var c=new Kinetic.Group({id:a.id,x:a.coords[0],y:a.coords[1],name:a.label,edges:[],type:a.type,nodeSize:a.size,color:a.color,draggable:!0,dragDistance:10});switch(a.type){case"Person":t=new Kinetic.Circle({radius:a.size,fill:a.color,stroke:d.calculateStrokeColor(a.color),strokeWidth:a.strokeWidth});break;case"Organisation":t=new Kinetic.Rect({width:2*a.size,height:2*a.size,fill:a.color,stroke:d.calculateStrokeColor(a.color),strokeWidth:a.strokeWidth,offset:{x:a.size,y:a.size}});break;case"OnlinePerson":t=new Kinetic.RegularPolygon({sides:3,fill:a.color,radius:1.2*a.size,stroke:d.calculateStrokeColor(a.color),strokeWidth:a.strokeWidth});break;case"Professional":t=new Kinetic.Star({numPoints:6,fill:a.color,innerRadius:a.size-a.size/3,outerRadius:a.size+a.size/3,stroke:d.calculateStrokeColor(a.color),strokeWidth:a.strokeWidth})}var l=new Kinetic.Text({text:a.label,fontSize:20,fontFamily:"Lato",fill:"white",offsetX:-1*a.size-10,offsetY:1*a.size-10,fontStyle:500});if(c.add(t),c.add(l),notify("Putting node "+a.label+" at coordinates x:"+a.coords[0]+", y:"+a.coords[1],2),session.log("nodeCreate",a,a.id),c.on("dragstart",function(){notify("dragstart",2),this.attrs.oldx=this.attrs.x,this.attrs.oldy=this.attrs.y,this.moveToTop(),r.draw()}),c.on("dragmove",function(){notify("Dragmove",2);var e=this;$.each(i.children,function(t,n){if(n.attrs.from===e||n.attrs.to===e){var o=[n.attrs.from.attrs.x,n.attrs.from.attrs.y,n.attrs.to.attrs.x,n.attrs.to.attrs.y];n.attrs.points=o}}),i.draw()}),c.on("tap click",function(){notify("tap or click.",2),session.log("nodeClick",this,this.attrs.id),this.moveToTop(),r.draw()}),c.on("dbltap dblclick",function(){notify("double tap",2),s.push(this),2===s.length?(d.addEdge(s[0],s[1])||d.removeEdge(s[0],s[1]),s[0].children[0].stroke(d.calculateStrokeColor(d.getNodeColorByType(s[0].attrs.type))),s[1].children[0].stroke(d.calculateStrokeColor(d.getNodeColorByType(s[1].attrs.type))),s=[],r.draw()):(this.children[0].stroke(f.selected),r.draw())}),c.on("dragend",function(){notify("dragend",2);var e={},t={};e.x=this.attrs.oldx,e.y=this.attrs.oldy,t.x=this.attrs.x,t.y=this.attrs.y;var n={from:e,to:t},o=this;session.log("nodeMove",n,this.attrs.id);var i=session.returnData("nodes");$.each(i,function(e,t){t.id===o.attrs.id&&(t.coords=[o.attrs.x,o.attrs.y],t.type=o.attrs.type)}),session.addData("nodes",i),delete this.attrs.oldx,delete this.attrs.oldy}),r.add(c),c.moveToBottom(),r.draw(),!e.coords){var y=new Kinetic.Tween({node:c,x:$(window).width()-150,y:100,duration:.7,easing:Kinetic.Easings.EaseOut});y.play()}return c},d.addEdge=function(e,t){var n=!1,o,a,s;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t?(o=e,a=t):(o=this.getNodeByID(e),a=this.getNodeByID(t)),i.children.length>0&&$.each(i.children,function(e,t){(t.attrs.from===o&&t.attrs.to===a||t.attrs.to===o&&t.attrs.from===a)&&(s=t,n=!0)}),n)return!1;var c=[o.attrs.x,o.attrs.y,a.attrs.x,a.attrs.y],l=new Kinetic.Line({strokeWidth:2,opacity:.5,stroke:h.defaultEdgeColor,from:o,to:a,points:c});i.add(l),i.draw(),r.draw(),notify("Created Edge between "+o.children[1].attrs.text+" and "+a.children[1].attrs.text,"success",2);var f=d.getSimpleEdge(i.children.length-1);return session.log("edgeCreate",f,"0"),!0},d.removeEdge=function(e){notify("Removing edge."),$.each(i.children,function(t,n){n===e&&(i.children[t].remove(),i.draw())})},d.calculateStrokeColor=function(e){return modifyColor(e,15)},d.clearGraph=function(){i.removeChildren(),i.clear(),r.removeChildren(),r.clear()},d.createRandomGraph=function(e,t){e=e||10,t=t||.4;var n=d.getKineticNodes();notify("Creating random graph...",1);for(var o=0;e>o;o++){var i=o+1;notify("Adding node "+i+" of "+e,2);var r={coords:[Math.round(randomBetween(100,window.innerWidth-100)),Math.round(randomBetween(100,window.innerHeight-100))]};session.addNode(r)}notify("Adding edges.",3),$.each(n,function(e){if(randomBetween(0,1)<t){var o=Math.round(randomBetween(0,n.length-1));d.addEdge(n[e],n[o])}})},d.initKinetic=function(){n=new Kinetic.Stage({container:"kineticCanvas",width:window.innerWidth,height:window.innerHeight}),o=new Kinetic.Layer,r=new Kinetic.Layer,i=new Kinetic.Layer,a=new Kinetic.Layer,n.add(o),n.add(i),n.add(r),n.add(a),notify("Kinetic stage initialised.",1)},d.drawUIComponents=function(){for(var e,t,n=h.concentricCircleColor,i=window.innerHeight-2*h.defaultNodeSize,r=.1,s=0;s<h.concentricCircleNumber;s++){var c=1-s/h.concentricCircleNumber,l=i/2*c;t=new Kinetic.Circle({x:window.innerWidth/2,y:window.innerHeight/2,radius:l,stroke:"white",strokeWidth:1.5,opacity:0}),e=new Kinetic.Circle({x:window.innerWidth/2,y:window.innerHeight/2,radius:l,fill:n,opacity:r,strokeWidth:0}),r+=(.3-r)/h.concentricCircleNumber,o.add(e),o.add(t)}var f=new Kinetic.Circle({radius:50,stroke:"#666",strokeWidth:0,y:window.innerHeight-100,x:100});f.on("click tap",function(){}),a.add(f),o.draw(),a.draw(),d.initNewNodeForm(),notify("User interface initialised.",1)},d.initNewNodeForm=function(){var e=$('<div class="new-node-form"></div>'),t=$('<div class="new-node-inner"></div>');e.append(t),t.append("<h1>Add a new contact</h1>"),t.append("<p>Some text accompanying the node creation box.</p>"),t.append('<input type="text" class="form-control name-box"></input>'),$(".content").after(e),$(document).on("keypress",function(e){if(!l&&(c||($(".new-node-form").addClass("node-form-open"),$(".content").addClass("blurry"),c=!0,$(".name-box").focus()),8!==e.which||$(e.target).is("input, textarea, div")||e.preventDefault(),13===event.which)){$(".new-node-form").removeClass("node-form-open"),$(".content").removeClass("blurry"),c=!1;var t={label:$(".name-box").val()};d.addNode(t),$(".name-box").val("")}})},d.getKineticNodes=function(){return r.children},d.getKineticEdges=function(){return i.children},d.getSimpleNodes=function(){var e={},t=d.getKineticNodes();return $.each(t,function(t,n){e[n.attrs.id]={},e[n.attrs.id].x=n.attrs.x,e[n.attrs.id].y=n.attrs.y,e[n.attrs.id].name=n.attrs.name,e[n.attrs.id].type=n.attrs.type,e[n.attrs.id].size=n.attrs.size,e[n.attrs.id].color=n.attrs.color}),e},d.getSimpleEdges=function(){var e={},t=0;return $.each(i.children,function(n,o){e[t]={},e[t].from=o.attrs.from.attrs.id,e[t].to=o.attrs.to.attrs.id,t++}),e},d.getSimpleEdge=function(e){var t=d.getSimpleEdges();if(!e)return!1;var n=t[e];return n},d.getEdgeLayer=function(){return i},d.getNodeByID=function(e){var t={},n=d.getKineticNodes();return $.each(n,function(n,o){o.attrs.id===e&&(t=o)}),t},d.getNodeColorByType=function(e){var t=null;return $.each(h.nodeTypes,function(n,o){o.name===e&&(t=o.color)}),t?t:!1},d.init(),d};
//# sourceMappingURL=./NetworkCanvas-min.map