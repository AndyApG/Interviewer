var OrdinalBin=function e(o){var t={};t.options={targetEl:$(".container"),edgeType:"Dyad",criteria:{from:network.getNodes({type_t0:"Ego"})[0].id},variable:{label:"gender_p_t0",values:["Female","Male","Transgender","Don't Know","Won't Answer"]},heading:"Default Heading",subheading:"Default Subheading."},extend(t.options,o);var a,n,i,d=function(){t.destroy()},l=function(){var e=$(this).data("value"),o=i,a={to:o};extend(a,t.options.criteria);var n=network.getEdges(a)[0],d={};d[t.options.followup.variable]=e,extend(n,d),network.updateEdge(n.id,n),$(".followup").hide()};return t.destroy=function(){notify("Destroying ordinalBin.",0),window.removeEventListener("changeStageStart",d,!1),$(document).off("click",".followup-option",l)},t.init=function(){t.options.targetEl.append("<h1>"+t.options.heading+"</h1>"),t.options.targetEl.append('<p class="lead">'+t.options.subheading+"</p>"),t.options.targetEl.append('<div class="node-bucket"></div>'),"undefined"!=typeof t.options.followup&&(t.options.targetEl.append('<div class="followup"><h2>'+t.options.followup.prompt+"</h2></div>"),$.each(t.options.followup.values,function(e,o){$(".followup").append('<span class="btn btn-primary btn-block followup-option" data-value="'+o.value+'">'+o.label+"</span>")}));var e=t.options.variable.values.length;a=$(".container").outerWidth()/e-20,n=$(".container").outerHeight()-400,$.each(t.options.variable.values,function(e,o){var a=$('<div class="ord-node-bin node-bin-static n'+e+'" data-index="'+e.value+'"><h1>'+o.label+'</h1><p class="lead">(Empty)</p><div class="active-node-list"></div></div>');a.data("index",e),t.options.targetEl.append(a),$(".n"+e).droppable({accept:".draggable",drop:function(o,a){var n=a.draggable,d=$(this);console.log("index is: "+t.options.variable.values[e].value),t.options.variable.values[e].value>0&&($(".followup").show(),i=$(n).data("node-id")),$(n).appendTo(d.children(".active-node-list")),$(n).css({position:"",top:"",left:""});var l={};l[t.options.variable.label]=t.options.variable.values[e].value;var r=network.getEdges({from:network.getNodes({type_t0:"Ego"})[0].id,to:$(n).data("node-id"),type:t.options.edgeType})[0].id;network.updateEdge(r,l),$.each($(".ord-node-bin"),function(e){var o=$(".n"+e).children(".active-node-list").children().length;if(o>0){var t="people";1===o&&(t="person"),$(".n"+e+" p").html(o+" "+t+".")}else $(".n"+e+" p").html("(Empty)")});var s=$(".n"+e);setTimeout(function(){s.transition({background:s.data("oldBg")},200,"ease")},0),$(".draggable").draggable({cursor:"pointer",revert:"invalid",disabled:!1,start:function(){$(".ord-node-bin").children(".active-node-list").css({overflow:"visible"})}})},over:function(){$(this).data("oldBg",$(this).css("background-color")),$(this).stop().transition({background:"rgba(255, 193, 0, 1.0)"},400,"ease")},out:function(){$(this).stop().transition({background:$(this).data("oldBg")},500,"ease")}})}),$(".ord-node-bin").css({width:a,height:n});var o=network.getEdges(t.options.criteria);$.each(o,function(e,o){var a;if("Dyad"!==t.options.criteria.type&&(console.log("dyadedge"),a=network.getEdges({from:o.from,to:o.to,type:"Dyad"})[0],console.log(a)),void 0!==o[t.options.variable.label]&&""!==o[t.options.variable.label]){e="error",$.each(t.options.variable.values,function(a,n){o[t.options.variable.label]===n.value&&(e=a)}),$(".n"+e).children(".active-node-list").append("Dyad"!==t.options.criteria.type?'<div class="node-item draggable" data-node-id="'+o.to+'">'+a.nname_t0+"</div>":'<div class="node-item draggable" data-node-id="'+o.to+'">'+o.nname_t0+"</div>");var n="people",i=$(".n"+e).children(".active-node-list").children().length;1===i&&(n="person"),$(".n"+e).children("p").html(0===i?"(Empty)":i+" "+n+".")}else $(".node-bucket").append("Dyad"!==t.options.criteria.type?'<div class="node-item draggable" data-node-id="'+o.to+'">'+a.nname_t0+"</div>":'<div class="node-item draggable" data-node-id="'+o.to+'">'+o.nname_t0+"</div>")}),$(".draggable").draggable({cursor:"pointer",revert:"invalid",disabled:!1,start:function(){$(".ord-node-bin").children(".active-node-list").css({overflow:"visible"})}}),window.addEventListener("changeStageStart",d,!1),$(document).on("click",".followup-option",l)},t.init(),t};